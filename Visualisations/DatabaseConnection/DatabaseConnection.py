from pymongo import MongoClient

class DatabaseConnection:
    debugSessionIds = [
        "100098162156200550876384166413318805194",
        "100791076829784311538777553313397622066",
        "100845778315810870381297666893312058560",
        "102313417323140926547887400500875042809",
        "10284872922298938270212915201316900598",
        "105578849649353579205604325916623082442",
        "106076319898654938516210404764181390687",
        "106563039490284856059072574589117842503",
        "107861383593120223856232148733774499634",
        "111315636062256536330279336482267063787",
        "111748846454960255697777895981811088022",
        "114124928985858559246652753906933567932",
        "116151029947935438853028769435334017364",
        "117717194807878827801552408942754553635",
        "117926317373266466157107284374827946144",
        "11869334356669164130640973680857056664",
        "118714242678899997472771907674739702852",
        "121896282140801974805816549141031973735",
        "122529207243324832685446571495103483613",
        "12541850902869437222688741249106215326",
        "127309816504281663885865719519876965431",
        "127615613026458713032686301709902576539",
        "128644601766156074555885835193838242927",
        "13003588624884147437037530600809982269",
        "131379918622922915065731494868356194228",
        "132743822903765424429622800087572183856",
        "13379136001073531258444292360856115375",
        "134250637263263090171422849459350960947",
        "134719013395651191042635559465054707718",
        "135312927729158973980791384588306065826",
        "135452660040185061244536656018077667400",
        "13587584217313558605765799277193588780",
        "136119576952264678145720395095599613851",
        "137058012824955348077410505829019148784",
        "137563301952548650695585607615372908288",
        "138857895488150079793929648137706237421",
        "140008720797955013730004013744649716637",
        "140274351570945304276050913011172036603",
        "141556469293547231305128345699628928489",
        "143344144143492124640124804979184874300",
        "143586471182772365308677473748369096340",
        "146909901174410040042392326145318171897",
        "147311853940011993539422902087300982970",
        "148406727501651431955780513712733441992",
        "149814676273419013149721504568464755434",
        "151377828364293379103161405386768675922",
        "152413750765510245624464548371368601913",
        "152819562921099789508252000718754255140",
        "154789518642175825687480686385860733768",
        "155452494037881028389327863101140194890",
        "156240082493014494544546328923032838532",
        "159808849928649646645922402368562144097",
        "160484469635228737222633868936562802821",
        "161624364075521334752360850871327785408",
        "161982062243649074634320969126954532886",
        "162028289422143974900977260683673723094",
        "162327128151118817418998330197307990054",
        "162592501768525619579742836081770841257",
        "162894508781621555841742443443713117812",
        "164532276608253456035167093251185474125",
        "165404678509366330054414143711196373617",
        "165699279399608280837590250765733732863",
        "165820327216082135721631402626404651156",
        "166430684697976841886630368793045127214",
        "166696090152014751019478684633221592439",
        "166706466899644882497914509309693677664",
        "172118350935123326372818814017003776221",
        "178875275208661804159060332376496868949",
        "178888818105058280466082838263910846733",
        "179145806051307330547860255972995663872",
        "182709107770683658338303605013884453918",
        "184210044878790029866407528325312692265",
        "185846076633135925266228729616756555539",
        "186684099918575949675506023710919614229",
        "187872983203687923727748894371152859899",
        "189007044969014776391015386544962574956",
        "190819340939776378693992563625809537925",
        "195430530531155352362104581217016724517",
        "198017339091772862093730085531440945472",
        "198338813509876407773313843541280364692",
        "200508039162385247059428211655675823439",
        "202381563582672196944461680727804065681",
        "205197584779029305464975423927945653315",
        "207093868655217744023716555332030394852",
        "207941665077051859494770897110907882022",
        "208114704810996079193311826536396140501",
        "209406031288077315468637223490420942059",
        "21271158596658162401179303593962031424",
        "213134055085801779053221505650113401493",
        "213278169701437006663412919451176954498",
        "21456439698528928698392279034911290278",
        "217555662701162262684771094453377739738",
        "217815235664639149164872667657155058614",
        "223651189725899866680043875504117231296",
        "224124899527406994384974989991345257956",
        "224528658820206646489999544834279555974",
        "226424596326276368304364332877701919886",
        "227774457182877875804404515696586409195",
        "230435531284864093632284161011372986880",
        "230706560390293761603314723634687456734",
        "233686884061739774629772954495192333164",
        "23433133639225217421646562428977486501",
        "235808832306776134137010086715171292838",
        "238755208351411449188605106735791301616",
        "238926563604501287367028024717024056620",
        "239030631468857181290510440832625672697",
        "239641455000841961419726286756439982390",
        "241717118459946511307277107629610938595",
        "242036105268082170669882450739403779805",
        "242513794525954699621547978991434074435",
        "242651728756765385950623910606333269884",
        "244116968846655985836198641569241722020",
        "245528804027734006715723816488961483613",
        "245563914619845640812179064098575176709",
        "245830903413418006848253725097655417482",
        "247540201062180724005430583876080115529",
        "248288118699879616154261988468860066441",
        "249920167079479997249198760820075384241",
        "249974491478252273609759513802922920822",
        "250306037528980588126556488380672456975",
        "250457313591535749510369453624673920374",
        "251387216072666120777764260647352145410",
        "255674495464960444997095670259626885413",
        "2559765746588462257903577985840697842",
        "256356723230531810460864781666270544610",
        "257313054760700816986291355173985291770",
        "260140719076288365501969595596165612393",
        "262402112337221531020877595437311643392",
        "26515638075565057894778458974858666374",
        "265667592281929272621280453087770179213",
        "266331577661207984412621982649023192176",
        "267470025023343921081139553052252135852",
        "267695063397927547937703729911302316426",
        "267751964590242399780982791217938838965",
        "268428003593238403305104483773086616950",
        "269092951056944560716437491575858277041",
        "27095215584968149506847010463975852827",
        "271145625140663070727163832098838789298",
        "271877581943654699975127574170909307294",
        "273918666711421551761260237092221448696",
        "27562289989847517030043963189913563175",
        "277131447634615156023543184210130622654",
        "277569555683541153984501809680301564718",
        "277925902568701102978042367607705317386",
        "278571444815490375669446139631302201772",
        "280699630038480156656278947247206462367",
        "281048648356420360819845558445921199474",
        "282438284583877639172288967291456154258",
        "283381907268860484957840748607688227891",
        "28865348897476278596254654074794037629",
        "289817011331915049788681749931380219269",
        "294233134219952226895524662784623818300",
        "298946973826558144626785033771537175249",
        "30575065889227405785384591345564150482",
        "31128392975166162848660274125113931212",
        "317168017570769142892434822598815093932",
        "317407657123402250232532369230581774942",
        "317810246765588381437691470656289959451",
        "318272758402471635118164486523949061512",
        "31996424765033535790830825417504319973",
        "319964997238640268141387599034106464566",
        "320372526446818370059990853651324864013",
        "321668714487694685937332549398939932950",
        "321758273587194590001139335682111461616",
        "324492423077297623441154728743411175054",
        "324991699820471444226518328382043806942",
        "325096310605120898939426942446448993091",
        "326393454686265890242579021355623568289",
        "326464857664489346448853378898737825791",
        "327746499830134339439538501858919723029",
        "328473379504667884069775334328335511830",
        "328682159766482723213243908976153457833",
        "33085078038657310865846512852402959491",
        "331794761032939412807267242052075156264",
        "332824460635691446214194648388939178409",
        "333393636261863167043220303048786987169",
        "334501103650690896431231396134637723178",
        "335409237152580489967886483185033025031",
        "335899919204216457480244276161425314830",
        "335919029540085196695712656358170197988",
        "335923968626649870829589186068970612693",
        "339238018698929913737428530862668047048",
        "34769837755236928352103578951381960254",
        "38273733567281486705033175654158376775",
        "40151403741696310291658634760587190865",
        "40756101720790868620023488623459135462",
        "41594516313067724339783441001364302440",
        "42136316273384504961750955187372527253",
        "42223839470522223384500961489852193134",
        "42852366113543178658788964953870543870",
        "47039539361269630107346621689912117723",
        "47273124640767011752348129589839659279",
        "50884787801807895152363786581925772541",
        "51127806518180553864088218054675367018",
        "51273380326331570584250388673771602212",
        "51725222373111934239641168861241156549",
        "52156141035247708431390232193243831878",
        "52691090132049262433734729815044986335",
        "52783788459314588286448579128518983480",
        "5317251866122907486713888819096553954",
        "54207834985272652828370125378223179707",
        "54500170284082014866468139221081040053",
        "56808603563978995377341662570667207130",
        "58157574345924746844269053154523314543",
        "59146520701249942020890391913627840064",
        "62021777235323476383770535091011196449",
        "62605816416331224750004039564907553645",
        "64831142422358753237491728318323368438",
        "65033631044991037149955625658720412100",
        "67118623552935537425310580260858109070",
        "68382240149084863252376729208949803643",
        "69573028114937800546852302081819111778",
        "71683108053760278088486179527355481078",
        "7414006559854129416113429278392933819",
        "75077197568383657933854333882497827627",
        "7637343558638212513585421888142581003",
        "78939224574137767695421262506942152077",
        "79432162011045936469217614760459720573",
        "8132455953832050105516726809592848956",
        "83521833134002890108416962256785968088",
        "84723308415416462302857232239099977867",
        "8498702668874009490272089176612538903",
        "87742456399758148001097793938016377487",
        "88130304745696567842832294317631369466",
        "88418151738019193375290410638868230485",
        "89967761835024251088062923134480485360",
        "90570604259713016509209925080607788727",
        "9074629638473392994209299704526514183",
        "90959537979126532584389476448893397369",
        "90981316506956637269670558265653470601",
        "91071306397263992738970652529452264258",
        "91279567330421387255820545461408166356",
        "91932501544047351811171491024215451529",
        "92068905529135683492567084209819583079",
        "93869881989254897091302111822109713286",
        "94488752762492682982947687611098168192",
        "94595606120245128711366429794467453192",
        "95039447919799438789968721780194389913",
        "96543936375017262228597878906026691547",
        "97359970685990310293431360503793410277",
        "97493640573516722971895222991847983632",
        "97493649192466294045996911997632333593",
        "98337268058732091586401751530579627811",
        "98723050124954722797928179077156364655",
        "99930641699826077487769976588799375801"
    ]
    createSessionIds = [
        "101353373570732381824116799233209664511",
        "101537932138396140015312752829262261735",
        "102597034802814374531877357330957916734",
        "105924397490726199156475864644906690129",
        "109206681864232309086541864428672217442",
        "109955979215631782203694481089834581984",
        "111063451419960437998902313142127244656",
        "11122534898580574992715957855324355261",
        "111611581556934531910946138614230368321",
        "1119212814414146320234354743175873907",
        "112961797669122926097291490558252751363",
        "113503599633604144573015042637418427403",
        "11515592966226135069949244428958948510",
        "115731467189902591911275658276690957950",
        "116154788186993302661978578662633364828",
        "11703948123289249840514264943654807570",
        "117259175969457724580376054263108220658",
        "119517158644056793395782504086760362279",
        "119572793856723272316585365337608575506",
        "12038739706746836128105087413272013322",
        "122314496211502099146414327362929532551",
        "123145216600054395929938318367782175185",
        "12359562815874014818551973490979433620",
        "125516675609022969344552997588320761510",
        "12593550028022991169443784208189442123",
        "128120795044846778768676848254900521811",
        "129503964841220209529060332730215224496",
        "130553056405723450548389719830694006740",
        "130925866024188956309996988924921179204",
        "131764766030447889675522041219879835828",
        "134966043293170591836352610389356610804",
        "135192316520025205812631178231857647238",
        "138656702642316400298423497771665478225",
        "139108264580231166602096942542212796881",
        "13995646743538880257615452954222749289",
        "140089985229682412465845498750201716285",
        "140910896512988682536499122592017414408",
        "141075724818251049583841973997917728169",
        "14152006528448271336366254300692703038",
        "142298770116630965603172175802203096651",
        "143334348661315600676166990571095130291",
        "144312382355533922189712768015601124021",
        "147059268241045796410301615511864868870",
        "150711009299885423384504440865247678933",
        "151558377847587020917367456079632419098",
        "152620133133659722788776658438155198389",
        "159063309706221536903404885645944400075",
        "159323961957799969098816322743077955771",
        "159957470226592255385163380205018475621",
        "16031867009696323382512669811186790717",
        "160331440674577328253607091105305560820",
        "161342666088214991449473441453156883637",
        "161985178377901800131229862988249128142",
        "164388789246866079872216445105201432683",
        "16615362594234198197744078713510140927",
        "166286948616903749113066860450076346326",
        "16772771589624079075296703823412510014",
        "168278856468612942408610737755257577242",
        "168404447331335634941865417414901376192",
        "168749456603521270179263109259786935970",
        "16958430018930103458793733067540113804",
        "17156111417213050326609656478445737422",
        "172041372478536333516708296717841683545",
        "172954515326810685265883646770875399874",
        "177005172541788870276691110651460367331",
        "177868060832540772744634905132256700008",
        "178339554966249103934447816453732837453",
        "180286461680726466847959664941682323713",
        "181827527241849325398168465067212330719",
        "182690473392511554909204058688738419099",
        "183889827865366016326131231971486875689",
        "185472318874560311298616512382147932035",
        "186587508180430160621715922775282626667",
        "188101709151297005383731575227236514905",
        "188331992217771547836243812329251077441",
        "189654868379424600216663745933156431066",
        "190341375358483662513229568067480865133",
        "19223581377874621391729908106256641886",
        "192435490502668058731988140981252019797",
        "193153885988792783160974506588369440411",
        "196011824426565865331963809234446803446",
        "196980319104124177453587031685302421497",
        "198070362896115494812894436403900034974",
        "198633073418107023925171366219874758782",
        "199767412500394026875788750259408205917",
        "200746358799241317924392310277033701478",
        "201232314971569053256294730795279676746",
        "206778013373611707857475859875194480528",
        "208175127041033329163811832597563428848",
        "208422281082181617045975959939634452042",
        "208651404832000897620039077598689353927",
        "209686612877819476445450923548754568609",
        "209924163828723088933761627666736286886",
        "210232754016706502504288503232138361126",
        "210503327250633317287400410199413371876",
        "21051573501993737596371322190163582713",
        "211253027673627968769465889815333062803",
        "212086137603425537739083619917812158800",
        "213796744660274711241810122483327065106",
        "215391175470835368307802657870966619782",
        "215445086319065199915002280089823993500",
        "216148056196150791854483428042810254770",
        "216469093625631170908144416755243154774",
        "216702356610803774461637255386182812084",
        "216737522812139435606423143158338043611",
        "218586681976293426717597314625731933862",
        "218953840326847199019081579487459915741",
        "220707028622859202404920952573934883235",
        "222066581107614631085752945971388582936",
        "22240567707603171224628457435037572571",
        "22454796781106295377727501471161083782",
        "226211835441933521511464784302840562008",
        "227177244233909777474402287374113039394",
        "227429622934811251305208838182741956970",
        "227883528818877107058499732402443536202",
        "229117539462191757955018787912073304652",
        "229690372454134804108728963190065351792",
        "229988490266635149462771722640485691529",
        "230260552721935423359542538114261171441",
        "230710218327369516822270862354253531520",
        "235679998312566505987591992990635012146",
        "238212159289557128301595984157059492320",
        "240011902280920585373735338144135360154",
        "241953805667571827920185465686025932349",
        "242015338481143075779044373120686219276",
        "242309206919026041106201886868078877246",
        "242731904842083988349731746102598888528",
        "244868035260434103951853955073742544754",
        "245222114922701618256493747535134248419",
        "245330190880824080937584674805917281611",
        "247191460673514373098028626066575733505",
        "247235684991167437344275965053782210486",
        "248079812782756912127401403654943049034",
        "248917092231375064830460586227621714313",
        "251480100010422932148504734149802521854",
        "251752938417185676933470665941108621307",
        "254907992375489957966266894791385177269",
        "256277312548666053782910631331490207102",
        "256548281663054716264627924925874830698",
        "256648081482366480811479397849950684244",
        "256982239570587276134967493028751184242",
        "258879499426722220147824406465214495673",
        "258932732778893177311527451546877632792",
        "259213377690698469446337009993119447012",
        "259970560135950534358365861160189991639",
        "26024184848161327679039361740626576684",
        "261353721647621799699917935659595296998",
        "261925639259572194357319065513836966861",
        "26213286834997291965258827995032200627",
        "266563998501787905248177767833889167092",
        "266687961690335723670860498378759018432",
        "266771307136338369494851777380281993463",
        "266949669044210811926344691919498178649",
        "269009369505612485758665647930780443742",
        "269855088721117114512264021508127462239",
        "270566867573240867449913705573629105149",
        "271736705596603583911977854667805114592",
        "271887090557175907259552412574724740446",
        "273116109288230648972926427862431002650",
        "275274351479049094709466879755073167588",
        "276107818895010610268792621423300271136",
        "283605399577348495748606162578052304764",
        "284840113159303394928479609596057263895",
        "285963940818219173386394634365863560059",
        "286860357720610521612829579399315083537",
        "289906114612856980426796703468716546154",
        "290408230653407146022438967874238092062",
        "291246361599380643694063075947451535779",
        "292558405726004115759841458301017149854",
        "29265863045997565682593430030873570259",
        "293507903541923572781138380510121669563",
        "29404690360849096033554949029773179407",
        "296903945583422565857364576305237912476",
        "29880855111417105778260964765225906812",
        "299248491144386992957855496500153619391",
        "299427244171875891430739996570688261629",
        "302147644378809799748454941489244707070",
        "303491729551153882403892489575034755097",
        "305594731067227859647307030813311593894",
        "30604864641908379523375279943541986347",
        "306330100323194266370007755007254645940",
        "311159816246010256675878553713123629806",
        "31174392073998455128478782465824903436",
        "314002750722983654386615972336926931266",
        "314521334372428822127928334901424440415",
        "315015001451231135617054854873082417900",
        "31655772019922239499162179956616268371",
        "317058519586546020602959468544699617741",
        "317364624328483239622855886884509613573",
        "319063364546704860609546254869420779662",
        "320405005061278478582598343672512024405",
        "322080165797412359021962540173734620474",
        "323427232207408245792511002956675410627",
        "329390334323576117295608836733331394991",
        "329538049724470132306912072685495037907",
        "330366790681164198338241005349529397596",
        "331186894979308015583285537078102406839",
        "33203091279800299565401513149765289670",
        "332160096045369577052124375602939097928",
        "332666115523774785097082523764839773766",
        "33356889121652924837636088876097109432",
        "337698162154795320214996988936373282517",
        "338181529685759280318634900993962434060",
        "338420310280881529660196743881409632915",
        "36058277662311892735614064306802652123",
        "36667558753863941986303201426690362398",
        "37990431202408973622850361907799744779",
        "38351500931781779181620715949540115668",
        "42267444183239888515421865339068841335",
        "43801288012215862679327049664693062758",
        "44278500876648978477847495404284172536",
        "46409048707050474093008625330229634663",
        "46424233979660049868925691579411882910",
        "46625839279864398448901186765454248951",
        "47339040704731237422465161694736094383",
        "47644993361355828935292039794145071006",
        "49184601044893475142728586916219505969",
        "52192337071007751407456819009041214547",
        "5283135856739024137036068627461582062",
        "54665170837612560883820980779388409476",
        "59600607460021647531664134555096153881",
        "60348685298330939456664973722517816733",
        "64243920243650003346562360741146976842",
        "64868164890579445853179064176513101112",
        "65736236594174822728766535336236530604",
        "65847368889008530160802400675326389897",
        "67137581441946713509134959294411740712",
        "68720941991397544799781489831748801596",
        "71307967888501512616617747682638100291",
        "72213045370297506496475233695523290661",
        "73453639887065412496700462878129521901",
        "75293042182075613076032358145895365873",
        "75914537691045933226293040967117398436",
        "76497462353248542700739869406521708606",
        "76722878635417517595372112374618929182",
        "8208720225607323948382371868527359221",
        "82419508017494499820736290288250051819",
        "87578589583176626917252461559057973509",
        "89297662470815003437541200420460008160",
        "89570608000905703102927994501875754984",
        "89619136239573068678392319197810169013",
        "90266768092005575376551986308851814403",
        "91185263755523433375410824484490688660",
        "93006151528761084048686973675006736588",
        "93806340741557184711497598983848492435",
        "94409040331688155131460822672629401204",
        "95034774209971961971585986211078802765",
        "95707618372767550406402477354128578656",
        "96642614785414295316321354109741964704",
        "97425823300638584217240115905656644214",
        "98815802023890322626078109214223096816",
        "99245909820474056157420475004560006718",
        "99394925682927067161021085618751898013"
    ]
    currentSessionIds = []

    def __init__(self):
        self.client = MongoClient('localhost:27017')
        self.databaseName = ""
        self.collectionName = ""
        self.sessionIds = {"BlocklyLogCreate": self.createSessionIds, "BlocklyLogDebug": self.debugSessionIds}

    def setDataSource(self, database, collection):
        self.databaseName = database
        self.collectionName = collection
        self.currentSessionIds = self.sessionIds[database]

    def getCurrentSessionIds(self):
        return self.currentSessionIds

    def queryCurrentCollection(self, query):
        return self.client[self.databaseName][self.collectionName].find(query)

    def aggregateOnCurrentCollection(self, filterPipeline):
        #return self.client[self.databaseName].command('aggregate', self.collectionName, pipeline=filterPipeline, explain=True)
        return self.client[self.databaseName][self.collectionName].aggregate(filterPipeline, allowDiskUse=True)

    def countQueryResults(self, filterPipeline):
        return self.client[self.databaseName][self.collectionName].count(filterPipeline)